<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å©šç¦®è·‘æ­¥éŠæˆ²</title>
  <style>
    body { text-align: center; font-family: sans-serif; background: #fff0f5; }
    h1 { color: #d63384; }
    .track { display: flex; flex-direction: column; margin: 20px; }
    .runner { height: 30px; background: pink; margin: 5px 0; text-align: left; white-space: nowrap; border-radius: 10px; }
    #clickBtn { margin-top: 20px; padding: 10px 20px; font-size: 18px; }
  </style>
</head>
<body>
  <h1>ğŸƒ å©šç¦®é»æ“Šè·‘æ­¥æ¯”è³½ ğŸ‰</h1>
  <input id="playerName" placeholder="è¼¸å…¥åå­—">
  <button id="joinBtn">åŠ å…¥éŠæˆ²</button>
  <br>
  <button id="clickBtn" disabled>é»æˆ‘è·‘ï¼</button>
  <div class="track" id="track"></div>

  <!-- Firebase CDN -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

  <script>
    // ğŸ”‘ é€™æ˜¯ä½ çš„ Wedding å°ˆæ¡ˆè¨­å®š
    var firebaseConfig = {
      apiKey: "AIzaSyAQzK5BX7q7uetIKxKyf86Xxxxxxxx",
      authDomain: "index-63c1d.firebaseapp.com",
      databaseURL: "https://index-63c1d-default-rtdb.firebaseio.com",
      projectId: "index-63c1d",
      storageBucket: "index-63c1d.appspot.com",
      messagingSenderId: "259240910482",
      appId: "1:259240910482:web:4e2d9a57fca6367848904b",
      measurementId: "G-YF4Y2S57DV"
    };
    firebase.initializeApp(firebaseConfig);
    var db = firebase.database();

    let playerName = "";
    const track = document.getElementById("track");

    // åŠ å…¥éŠæˆ²
    document.getElementById("joinBtn").onclick = () => {
      playerName = document.getElementById("playerName").value;
      if (!playerName) return alert("è«‹è¼¸å…¥åå­—");
      db.ref("players/" + playerName).set({ steps: 0 });
      document.getElementById("clickBtn").disabled = false;
    };

    // é»æ“Šå‰é€²
    document.getElementById("clickBtn").onclick = () => {
      db.ref("players/" + playerName + "/steps").transaction(s => (s||0)+1);
    };

    // å³æ™‚é¡¯ç¤ºæ‰€æœ‰ç©å®¶é€²åº¦
    db.ref("players").on("value", snapshot => {
      track.innerHTML = "";
      const players = snapshot.val();
      for (let name in players) {
        let steps = players[name].steps;
        let runner = document.createElement("div");
        runner.className = "runner";
        runner.style.width = steps * 10 + "px";
        runner.innerText = name + " ğŸƒ (" + steps + ")";
        track.appendChild(runner);
      }
    });
  </script>
</body>
</html>
