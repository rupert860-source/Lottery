<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>婚禮搶氣球遊戲</title>
  <style>
    body {
      text-align: center;
      background: url('https://images.unsplash.com/photo-1529634898661-f1a8b5d3d0b2?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80') no-repeat center center fixed;
      background-size: cover;
      font-family: Arial, sans-serif;
      color: white;
    }
    .balloon {
      width: 120px;
      height: 160px;
      border-radius: 60% 60% 60% 60%;
      background: pink;
      margin: 20px auto;
      position: relative;
      cursor: pointer;
      box-shadow: 0 0 15px rgba(0,0,0,0.3);
    }
    .balloon span {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 20px;
      font-weight: bold;
      color: black;
    }
    #scoreboard {
      margin-top: 20px;
      font-size: 20px;
    }
  </style>
</head>
<body>
  <h1>🎉 婚禮搶氣球遊戲 🎈</h1>
  <p>點擊你的氣球，把它戳破！數據會即時同步</p>

  <div id="balloons"></div>
  <div id="scoreboard"></div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

  <script>
    // 這裡換成你的 Firebase 專案設定
    const firebaseConfig = {
      apiKey: "你的API_KEY",
      authDomain: "你的專案ID.firebaseapp.com",
      databaseURL: "https://你的專案ID.firebaseio.com",
      projectId: "你的專案ID",
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // 玩家清單
    const players = ["A", "B", "C", "D", "E"];
    const clickLimit = 100; // 氣球上限

    const balloonContainer = document.getElementById("balloons");
    const scoreboard = document.getElementById("scoreboard");

    // 建立氣球按鈕
    players.forEach(player => {
      const balloon = document.createElement("div");
      balloon.className = "balloon";
      balloon.id = "balloon-" + player;
      balloon.innerHTML = `<span>${player}</span>`;
      balloon.onclick = () => addClick(player);
      balloonContainer.appendChild(balloon);
    });

    // 點擊事件 → 更新 Firebase
    function addClick(player) {
      const ref = db.ref("game/" + player);
      ref.transaction(n => {
        if (!n) return 1;
        if (n >= clickLimit) return n; // 達到上限不再增加
        return n + 1;
      });
    }

    // 監聽即時更新
    db.ref("game").on("value", snapshot => {
      const scores = snapshot.val() || {};
      updateUI(scores);
    });

    // 更新畫面
    function updateUI(scores) {
      scoreboard.innerHTML = "";
      players.forEach(player => {
        const count = scores[player] || 0;
        const balloon = document.getElementById("balloon-" + player);

        // 更新大小
        const scale = 1 + count / clickLimit;
        balloon.style.transform = `scale(${scale})`;

        // 爆掉
        if (count >= clickLimit) {
          balloon.style.background = "gray";
          balloon.innerHTML = `<span>💥 ${player}</span>`;
        } else {
          balloon.innerHTML = `<span>${player} (${count})</span>`;
        }

        // 計分板
        scoreboard.innerHTML += `${player}：${count} 次<br>`;
      });
    }
  </script>
</body>
</html>
