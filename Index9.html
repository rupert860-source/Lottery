<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>å©šç¦®æ¶æ°£çƒéŠæˆ²</title>
  <style>
    body {
      text-align: center;
      background: url('https://images.unsplash.com/photo-1529634898661-f1a8b5d3d0b2?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80') no-repeat center center fixed;
      background-size: cover;
      font-family: Arial, sans-serif;
      color: white;
    }
    .balloon {
      width: 120px;
      height: 160px;
      border-radius: 60% 60% 60% 60%;
      background: pink;
      margin: 20px auto;
      position: relative;
      cursor: pointer;
      box-shadow: 0 0 15px rgba(0,0,0,0.3);
    }
    .balloon span {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 20px;
      font-weight: bold;
      color: black;
    }
    #scoreboard {
      margin-top: 20px;
      font-size: 20px;
    }
  </style>
</head>
<body>
  <h1>ğŸ‰ å©šç¦®æ¶æ°£çƒéŠæˆ² ğŸˆ</h1>
  <p>é»æ“Šä½ çš„æ°£çƒï¼ŒæŠŠå®ƒæˆ³ç ´ï¼æ•¸æ“šæœƒå³æ™‚åŒæ­¥</p>

  <div id="balloons"></div>
  <div id="scoreboard"></div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

  <script>
    // é€™è£¡æ›æˆä½ çš„ Firebase å°ˆæ¡ˆè¨­å®š
    const firebaseConfig = {
      apiKey: "ä½ çš„API_KEY",
      authDomain: "ä½ çš„å°ˆæ¡ˆID.firebaseapp.com",
      databaseURL: "https://ä½ çš„å°ˆæ¡ˆID.firebaseio.com",
      projectId: "ä½ çš„å°ˆæ¡ˆID",
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // ç©å®¶æ¸…å–®
    const players = ["A", "B", "C", "D", "E"];
    const clickLimit = 100; // æ°£çƒä¸Šé™

    const balloonContainer = document.getElementById("balloons");
    const scoreboard = document.getElementById("scoreboard");

    // å»ºç«‹æ°£çƒæŒ‰éˆ•
    players.forEach(player => {
      const balloon = document.createElement("div");
      balloon.className = "balloon";
      balloon.id = "balloon-" + player;
      balloon.innerHTML = `<span>${player}</span>`;
      balloon.onclick = () => addClick(player);
      balloonContainer.appendChild(balloon);
    });

    // é»æ“Šäº‹ä»¶ â†’ æ›´æ–° Firebase
    function addClick(player) {
      const ref = db.ref("game/" + player);
      ref.transaction(n => {
        if (!n) return 1;
        if (n >= clickLimit) return n; // é”åˆ°ä¸Šé™ä¸å†å¢åŠ 
        return n + 1;
      });
    }

    // ç›£è½å³æ™‚æ›´æ–°
    db.ref("game").on("value", snapshot => {
      const scores = snapshot.val() || {};
      updateUI(scores);
    });

    // æ›´æ–°ç•«é¢
    function updateUI(scores) {
      scoreboard.innerHTML = "";
      players.forEach(player => {
        const count = scores[player] || 0;
        const balloon = document.getElementById("balloon-" + player);

        // æ›´æ–°å¤§å°
        const scale = 1 + count / clickLimit;
        balloon.style.transform = `scale(${scale})`;

        // çˆ†æ‰
        if (count >= clickLimit) {
          balloon.style.background = "gray";
          balloon.innerHTML = `<span>ğŸ’¥ ${player}</span>`;
        } else {
          balloon.innerHTML = `<span>${player} (${count})</span>`;
        }

        // è¨ˆåˆ†æ¿
        scoreboard.innerHTML += `${player}ï¼š${count} æ¬¡<br>`;
      });
    }
  </script>
</body>
</html>
