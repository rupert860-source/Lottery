<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å©šç¦®å¹¸é‹æŠ½ç</title>
<style>
  body {
    font-family: 'Arial', sans-serif;
    text-align: center;
    padding: 50px;
    background: #fff0f5;
  }
  h1 {
    color: #d147a3;
    font-size: 36px;
  }
  #playerList {
    margin: 20px 0;
    font-size: 18px;
    color: #555;
  }
  #winner {
    margin-top: 30px;
    font-size: 28px;
    color: #d147a3;
    font-weight: bold;
  }
  input {
    padding: 8px;
    font-size: 16px;
    margin-bottom: 10px;
  }
  button {
    padding: 12px 25px;
    font-size: 18px;
    background: #d147a3;
    color: white;
    border: none;
    cursor: pointer;
    border-radius: 8px;
    margin: 5px;
  }
  #confetti-canvas {
    position: fixed;
    pointer-events: none;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 9999;
  }
</style>
</head>
<body>

<h1>å©šç¦®å¹¸é‹æŠ½ç</h1>
<p>è«‹è¼¸å…¥ä½ çš„åå­—åƒåŠ æŠ½çï¼š</p>
<input type="text" id="playerName" placeholder="åå­—">
<button id="joinBtn">åŠ å…¥åå–®</button>

<div id="playerList"></div>

<button id="drawBtn">é–‹å§‹æŠ½ç</button>

<div id="winner"></div>
<canvas id="confetti-canvas"></canvas>

<script>
  const joinBtn = document.getElementById('joinBtn');
  const drawBtn = document.getElementById('drawBtn');
  const playerNameInput = document.getElementById('playerName');
  const playerListDiv = document.getElementById('playerList');
  const winnerDiv = document.getElementById('winner');
  const confettiCanvas = document.getElementById('confetti-canvas');
  const confettiCtx = confettiCanvas.getContext('2d');

  let players = [];
  let prizes = ["ç´…åŒ…", "å©šç¦®å°ç¦®ç‰©", "ç´€å¿µå“", "ç”œé»", "é¦™æ°´", "å·§å…‹åŠ›"];
  let colors = ["#FF6B6B", "#FFD93D", "#6BCB77", "#4D96FF", "#FF6FF0", "#FF9F1C"];
  confettiCanvas.width = window.innerWidth;
  confettiCanvas.height = window.innerHeight;

  // åŠ å…¥åå–®
  joinBtn.addEventListener('click', () => {
    const name = playerNameInput.value.trim();
    if(name){
      players.push(name);
      playerListDiv.innerHTML = "ç›®å‰åƒåŠ åå–®ï¼š" + players.join("ã€");
      playerNameInput.value = '';
    } else {
      alert('è«‹è¼¸å…¥åå­—ï¼');
    }
  });

  // éŸ³æ•ˆ
  const drawSound = new Audio('https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg');
  const winSound = new Audio('https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg');

  // æŠ½ç
  drawBtn.addEventListener('click', () => {
    if(players.length === 0){
      alert('è«‹å…ˆåŠ å…¥è‡³å°‘ä¸€ä½ç©å®¶ï¼');
      return;
    }
    drawBtn.disabled = true;
    drawSound.play();

    const winnerPlayer = players[Math.floor(Math.random() * players.length)];
    const winnerPrize = prizes[Math.floor(Math.random() * prizes.length)];

    setTimeout(() => {
      winnerDiv.textContent = `æ­å–œ ${winnerPlayer} ç²å¾— ${winnerPrize} ğŸ‰`;
      winSound.play();
      launchConfetti();
      drawBtn.disabled = false;
    }, 1500);
  });

  // å½©å¸¶æ•ˆæœ
  function launchConfetti() {
    let confetti = [];
    for (let i = 0; i < 150; i++) {
      confetti.push({
        x: Math.random() * confettiCanvas.width,
        y: Math.random() * confettiCanvas.height - confettiCanvas.height,
        r: Math.random() * 6 + 4,
        d: Math.random() * 20,
        color: colors[Math.floor(Math.random() * colors.length)],
        tilt: Math.random() * 10 - 10,
        tiltAngleIncremental: Math.random() * 0.07 + 0.05,
        tiltAngle: 0
      });
    }

    function draw() {
      confettiCtx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
      confetti.forEach((c) => {
        confettiCtx.beginPath();
        confettiCtx.lineWidth = c.r / 2;
        confettiCtx.strokeStyle = c.color;
        confettiCtx.moveTo(c.x + c.tilt + c.r / 4, c.y);
        confettiCtx.lineTo(c.x + c.tilt, c.y + c.tilt + c.r / 4);
        confettiCtx.stroke();
      });
      update();
    }

    function update() {
      confetti.forEach((c) => {
        c.tiltAngle += c.tiltAngleIncremental;
        c.y += (Math.cos(c.d) + 3 + c.r/2)/2;
        c.tilt = Math.sin(c.tiltAngle) * 15;

        if (c.y > confettiCanvas.height) {
          c.y = -10;
          c.x = Math.random() * confettiCanvas.width;
        }
      });
    }

    let animation = setInterval(draw, 20);
    setTimeout(() => clearInterval(animation), 5000);
  }
</script>

</body>
</html>
