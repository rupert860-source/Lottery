<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å©šç¦®è·‘æ­¥éŠæˆ²</title>
  <style>
    body { text-align: center; font-family: sans-serif; }
    .track { display: flex; flex-direction: column; margin: 20px; }
    .runner { height: 30px; background: pink; margin: 5px 0; text-align: left; }
  </style>
</head>
<body>
  <h1>ğŸƒ å©šç¦®é»æ“Šè·‘æ­¥æ¯”è³½ ğŸ‰</h1>
  <input id="playerName" placeholder="è¼¸å…¥åå­—">
  <button id="joinBtn">åŠ å…¥éŠæˆ²</button>
  <button id="clickBtn" disabled>é»æˆ‘è·‘ï¼</button>
  <div class="track" id="track"></div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>
  <script>
    // âœ… é€™è£¡æ›æˆä½ çš„ firebaseConfig
    const firebaseConfig = {
      apiKey: "YOUR_KEY",
      authDomain: "YOUR_PROJECT.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT.firebaseio.com",
      projectId: "YOUR_PROJECT",
      storageBucket: "YOUR_PROJECT.appspot.com",
      messagingSenderId: "XXXX",
      appId: "XXXX"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let playerName = "";
    const track = document.getElementById("track");

    document.getElementById("joinBtn").onclick = () => {
      playerName = document.getElementById("playerName").value;
      if (!playerName) return alert("è«‹è¼¸å…¥åå­—");
      db.ref("players/" + playerName).set({ steps: 0 });
      document.getElementById("clickBtn").disabled = false;
    };

    document.getElementById("clickBtn").onclick = () => {
      db.ref("players/" + playerName + "/steps").transaction(s => (s||0)+1);
    };

    // å³æ™‚é¡¯ç¤ºæ‰€æœ‰ç©å®¶é€²åº¦
    db.ref("players").on("value", snapshot => {
      track.innerHTML = "";
      const players = snapshot.val();
      for (let name in players) {
        let steps = players[name].steps;
        let runner = document.createElement("div");
        runner.className = "runner";
        runner.style.width = steps * 10 + "px";
        runner.innerText = name + " ğŸƒ (" + steps + ")";
        track.appendChild(runner);
      }
    });
  </script>
</body>
</html>
